
# Задание

Написать HTTP  handler, генерирующий отчет по заказам в базе Northwind.

Handler должен уметь:

· Принимать параметры:

o в виде строки запроса (т.е. вида [http://host/Report?param1=value1&param1](http://host/Report?param1=value1&param1)=...)

o или в теле запроса (в формате application/x-www-form-urlencoded)

· Поддерживать параметры:

o customer – ID заказчика

o dateFrom / dateTo – период дат на которые нужно выдать заказы (заказы фильтруются по дате OrderDate включительно). Может быть указан только 1 параметер

o take – сколько заказов вернуть.

o skip – сколько заказов пропустить

**В отчете заказы упорядочиваются по OrderID****!**

Любой из перечисленных параметров может быть пропущен, в этом случае определяемое им условие выборки не применяется.

· Анализировать заголовок Accept и возвращать отчет в следующих форматах
![](https://i3.yapics.com/03/29/3329Y29R03.png)

· Указывать в ответе правильный Content-Type (так, чтобы при открытии из браузера – открывался нужный редактор/просмотрщик)

Для тестирования handler напишите набор интеграционных тестов, работающих поверх HttpClient и проверяющих различные варианты вызова handler.

# Замечания по реализации

Состав возвращаемых из базы Order полей, а также структуру XML – определяете сами.

Для формирования Excel можно использовать

· [OpenXML SDK](https://www.nuget.org/packages/DocumentFormat.OpenXml/)

Но рекомендуется воспользоваться более простым [ClosedXML](https://github.com/closedxml/closedxml)
